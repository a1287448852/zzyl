import{_ as q,d as I,u as J,r as d,b as T,y as L,e as m,h as b,q as a,i as u,w as s,G as H,a7 as Q,ai as K,J as O,M as g,aj as W,o as p,B as v,z as c,F as x,E as D,f as X,A as Y,g as h,Q as Z}from"./index.c5b6faf2.js";import{d as $}from"./commonData.8892e613.js";const ee={class:"bg-wt contentBox"},ue=a("div",{class:"headbox"},"\u4E2A\u4EBA\u4FE1\u606F",-1),ae={class:"bodybox"},le={class:"leftBox"},te=a("span",null,",",-1),se={class:"rightBox"},oe=a("div",{class:"t-form__label file"},"\u5934\u50CF",-1),re=a("span",null,[a("svg",{t:"1674963121719",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2386",width:"128",height:"128"},[a("path",{d:"M544 736a32 32 0 0 1-64 0V288a32 32 0 0 1 64 0z","p-id":"2387"}),a("path",{d:"M800 832V672a32 32 0 0 1 64 0v192a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V672a32 32 0 0 1 64 0v160zM496 271.36l-152.32 166.4a32 32 0 1 1-47.36-43.52l176-192a32 32 0 0 1 47.36 0l176 192a32 32 0 0 1-47.36 43.52z","p-id":"2388"})])],-1),ne={name:"UserIndex"},ie=I({...ne,setup(de){const y=J(),e=d({}),C=d(null),V=d(!0),w=d({size:60,unit:"MB",message:"\u56FE\u7247\u5927\u5C0F\u8D85\u8FC760m\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"}),F=d(!1);T();const o=d([{url:""}]),_=d([{url:"https://yjy-oss-videos.oss-accelerate.aliyuncs.com/grzxhz.jpg"}]),E=d(),N=()=>{o.value=_.value},A=async()=>{const r=await H();e.value=r.data,e.value.sex=Number(e.value.sex),e.value.mobile&&(e.value.phone=e.value.mobile,e.value.mobile=Q(e.value.mobile)),e.value.avatar?(o.value[0].avatar=e.value.avatar,o.value[0].url=e.value.avatar):(o.value[0].url=_.value[0].url,e.value.avatar=_.value[0].url)},z=()=>{if(F.value)return!0;C.value.validate().then(async r=>{if(r===!0){F.value=!0;const l=K(e.value.mobile),n={realName:e.value.realName,mobile:l?e.value.phone:e.value.mobile,avatar:o.value[0].url,sex:e.value.sex,id:e.value.id};if(!O(n.mobile))return g.error("\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165"),F.value=!1,!1;await W(n).then(f=>{f.code===200&&(g.success("\u64CD\u4F5C\u6210\u529F"),y.setUserAvatar(n),A(),setTimeout(()=>{F.value=!1,clearTimeout()},3e3))}).catch(f=>{F.value=!1})}})},k=()=>{E.value.triggerUpload()},U=r=>r.size>2*1024*1024?(g.error("\u56FE\u7247\u5927\u5C0F\u8D85\u8FC72M\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20"),!1):!0,j=(r,l)=>{const n=r.response.data;e.value.avatar=n,o.value[0].response.url=n,o.value[0].url=n},M=r=>{Z(r)||(e.value.mobile="")};L(()=>{A()});const P=d({realName:[{required:!0,message:"\u59D3\u540D\u4E3A\u7A7A,\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],avatar:[{required:!0,message:"\u5934\u50CF\u4E3A\u7A7A\uFF0C\u8BF7\u4E0A\u4F20\u5934\u50CF",type:"error",trigger:"change"}]});return(r,l)=>{const n=m("t-input"),i=m("t-form-item"),f=m("t-radio"),S=m("t-radio-group"),G=m("t-upload"),R=m("t-form");return p(),b("div",ee,[ue,a("div",ae,[u(R,{ref_key:"form",ref:C,rules:P.value,data:e.value,"label-width":70},{default:s(()=>[a("div",le,[u(i,{label:"\u59D3\u540D\uFF1A",name:"realName"},{default:s(()=>[u(n,{modelValue:e.value.realName,"onUpdate:modelValue":l[0]||(l[0]=t=>e.value.realName=t),placeholder:"\u8BF7\u8F93\u5165",class:"wt-300",clearable:"","show-limit-number":"",maxlength:10},null,8,["modelValue"])]),_:1}),u(i,{label:"\u90AE\u7BB1\uFF1A",name:"nickname"},{default:s(()=>[v(c(e.value.email),1)]),_:1}),u(i,{label:"\u6240\u5C5E\u90E8\u95E8\uFF1A",name:"description"},{default:s(()=>[v(c(e.value.deptName),1)]),_:1}),u(i,{label:"\u6240\u5C5E\u804C\u4F4D\uFF1A",name:"region"},{default:s(()=>[v(c(e.value.postName),1)]),_:1}),u(i,{label:"\u89D2\u8272\uFF1A",name:"address"},{default:s(()=>[(p(!0),b(x,null,D(e.value.roleNames,(t,B)=>(p(),b("span",{key:B,class:"role"},[v(c(t),1),te]))),128))]),_:1}),u(i,{label:"\u624B\u673A\u53F7\uFF1A",name:"mobile"},{default:s(()=>[u(n,{modelValue:e.value.mobile,"onUpdate:modelValue":l[1]||(l[1]=t=>e.value.mobile=t),placeholder:"\u8BF7\u8F93\u5165",class:"wt-300",clearable:"","show-limit-number":"",maxlength:11,onChange:M},null,8,["modelValue"])]),_:1}),u(i,{label:"\u6027\u522B\uFF1A",name:"sex"},{default:s(()=>[u(S,{modelValue:e.value.sex,"onUpdate:modelValue":l[2]||(l[2]=t=>e.value.sex=t)},{default:s(()=>[(p(!0),b(x,null,D(Y($),(t,B)=>(p(),X(f,{key:B,value:t.id},{default:s(()=>[v(c(t.value),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),a("div",se,[u(i,{name:"avatar"},{default:s(()=>[oe,u(G,{ref_key:"uploadRef1",ref:E,modelValue:o.value,"onUpdate:modelValue":l[3]||(l[3]=t=>o.value=t),action:"api/common/upload","is-batch-upload":!0,autoUpload:V.value,"size-limit":w.value,tips:"\u56FE\u7247\u5927\u5C0F\u4E0D\u8D85\u8FC72M,\u4EC5\u652F\u6301\u4E0A\u4F20PNG JPG JPEG\u7C7B\u578B\u56FE\u7247",theme:"image",accept:".jpg,.jpeg,.png","before-upload":U,onRemove:N,onSuccess:j},null,8,["modelValue","autoUpload","size-limit"]),h(" \u5916\u90E8\u4E5F\u53EF\u70B9\u51FB\u89E6\u53D1\u4E0A\u4F20\u529F\u80FD "),a("button",{class:"upbtn",onClick:k},[h(" \u4F7F\u7528svg\u56FE "),re,h(" \u5224\u65AD\u5934\u50CF\u6846\u5185\u662F\u5426\u6709\u5185\u5BB9\uFF0C\u6709\u5185\u5BB9\u663E\u793A\u91CD\u65B0\u4E0A\u4F20\uFF0C\u6CA1\u6709\u5185\u5BB9\u663E\u793A\u4E0A\u4F20\u6587\u4EF6 "),v(" "+c(o.value[0].url!==_.value[0].url?"\u91CD\u65B0\u4E0A\u4F20":"\u4E0A\u4F20\u6587\u4EF6"),1)])]),_:1})])]),_:1},8,["rules","data"]),a("div",{class:"boxBottom fx fx-ct bg-wt"},[a("button",{class:"bt wt-60",theme:"primary",onClick:z}," \u4FDD\u5B58 ")])])])}}});var ce=q(ie,[["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/user/personal/index.vue"]]);export{ce as default};
