import{d as J,r as t,y as X,M as z,C as P,e as y,o as R,h as U,i as s,w as f,q as p,z as O,g as c,_ as W,ac as Z,p as ee,m as te,R as ae,f as le,B as oe,n as G,A as ue,c as ne,a0 as se}from"./index.c5b6faf2.js";import{n as de,g as re,o as ie,p as ce,q as Y,r as pe,s as ve}from"./permission.69e815b3.js";import{P as me}from"./ProdDisabled.951b0c1e.js";import{D as fe}from"./disable.4394386d.js";import{N as _e}from"./index.ea73f821.js";const Q=g=>(ee("data-v-493d6187"),g=g(),te(),g),he={class:"dialog-form"},be={class:"dialog-header"},ge={class:"dialog-title"},De=Q(()=>p("span",{class:"information"},null,-1)),Ee=Q(()=>p("span",null,"\u53D6\u6D88",-1)),Ne=[Ee],Fe=Q(()=>p("button",{theme:"primary",type:"submit",class:"bt btn-submit"},[p("span",null,"\u786E\u5B9A")],-1)),Ce=J({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},title:{type:String,default:"\u65B0\u5EFA\u90E8\u95E8"}},emits:["handleClose","fetchData","refreshTable"],setup(g,{expose:r,emit:F}){const v=g,_=t("empty"),h=F,D=t(!1),S=t(0),e=t({deptName:"",leaderId:"",parentDeptNo:"",leaderName:"",dataState:"",sortNo:0,remark:""}),C=t(""),k=t(),V=t([]),B=t([]),i=t(""),x=t("");X(()=>{T(),u()});const L=a=>{Z(a)},I=()=>{const a=Number(e.value.sortNo);a<=0?e.value.sortNo=0:a>=9999&&(e.value.sortNo=9999)},T=async()=>{de({level:3}).then(a=>{a.code===200&&(V.value=a.data.items,console.log(V.value,"-------------"))}).catch(a=>{z.error(`\u90E8\u95E8\u6570\u636E\u83B7\u53D6\u5931\u8D25! ${a.message}`)})},u=async()=>{re().then(a=>{a.code===200&&(B.value=a.data.map(l=>({value:l.id,label:l.realName})))})},d=a=>{a.validateResult===!0&&(v.title==="\u65B0\u589E\u90E8\u95E8"?A(e.value):n(e.value))},m=a=>{console.log(a,B.value,"val"),a?e.value.leaderName=B.value.filter(l=>l.value===a)[0].label:e.value.leaderName=a,console.log(a,"vvvv")},A=async a=>{ie(a).then(l=>{l.code===200&&(z.success("\u90E8\u95E8\u6DFB\u52A0\u6210\u529F"),T(),h("fetchData"),h("refreshTable",{...a},"add"),b())})},n=a=>{ce(a).then(l=>{l.code===200&&(z.success("\u90E8\u95E8\u4FEE\u6539\u6210\u529F"),T(),h("fetchData"),h("refreshTable",{...a,originLeaderId:i.value,originSortNo:x.value},"edit"),b())})},b=()=>{k.value.reset(),e.value.sortNo=0,e.value.leaderId="",D.value=!1,h("handleClose")};P(()=>v.visible,a=>{if(C.value=v.title,D.value=v.visible,console.log(v,"props"),a){const{data:l}=v;v.title==="\u65B0\u589E\u90E8\u95E8"?(e.value.parentDeptNo=l.parentDeptNo,e.value.dataState=l.dataState):(i.value=l.leaderId,x.value=l.sortNo,e.value=JSON.parse(JSON.stringify(l))),e.value.parentDeptNo=l.parentDeptNo!==void 0?String(l.parentDeptNo):"",console.log(e.value,"val")}}),r({fetchData:T});const j={dataState:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8\u72B6\u6001",type:"error",trigger:"blur"}],parentDeptNo:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8",type:"error",trigger:"change"}],deptName:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",type:"error",trigger:"blur"}],sortNo:[{required:!0,message:"\u8BF7\u8F93\u5165\u663E\u793A\u6392\u5E8F",type:"error",trigger:"blur"}]};return(a,l)=>{const w=y("t-cascader"),E=y("t-form-item"),q=y("t-input"),M=y("t-input-number"),o=y("t-select"),$=y("t-textarea"),H=y("t-form"),K=y("t-dialog");return R(),U("div",he,[s(K,{visible:D.value,"onUpdate:visible":l[5]||(l[5]=N=>D.value=N),footer:!1,"on-close":b,closeOnEscKeydown:!1},{header:f(()=>[p("div",be,[p("span",ge,O(C.value),1),De])]),body:f(()=>[c(" \u8868\u5355\u5185\u5BB9 "),s(H,{ref_key:"form",ref:k,data:e.value,rules:j,"label-width":95,"on-cancel":"onClickCloseBtn","reset-type":_.value,onSubmit:d},{default:f(()=>[s(E,{label:"\u4E0A\u7EA7\u90E8\u95E8\uFF1A",name:"parentDeptNo"},{default:f(()=>[s(w,{modelValue:e.value.parentDeptNo,"onUpdate:modelValue":l[0]||(l[0]=N=>e.value.parentDeptNo=N),keys:{label:"label",value:"id",children:"children"},options:V.value,"check-strictly":"",filterable:"",clearable:""},null,8,["modelValue","options"])]),_:1}),s(E,{label:"\u90E8\u95E8\u540D\u79F0\uFF1A",name:"deptName"},{default:f(()=>[s(q,{modelValue:e.value.deptName,"onUpdate:modelValue":l[1]||(l[1]=N=>e.value.deptName=N),placeholder:"\u8BF7\u8F93\u5165 ",clearable:"",maxlength:10,"show-limit-number":""},null,8,["modelValue"])]),_:1}),s(E,{label:"\u6392\u5E8F\uFF1A",name:"sortNo"},{default:f(()=>[s(M,{modelValue:e.value.sortNo,"onUpdate:modelValue":l[2]||(l[2]=N=>e.value.sortNo=N),min:S.value,onBlur:I,onOnkeyup:L,onChange:I},null,8,["modelValue","min"])]),_:1}),c(` <t-form-item label="\u90E8\u95E8\u72B6\u6001\uFF1A" name="dataState">\r
            <t-radio-group\r
              v-model="formData.dataState"\r
              :default-value="formData.dataState"\r
            >\r
              <t-radio :value="'0'">\u542F\u7528</t-radio>\r
              <t-radio :value="'1'">\u7981\u7528</t-radio>\r
            </t-radio-group>\r
          </t-form-item> `),s(E,{label:"\u90E8\u95E8\u8D1F\u8D23\u4EBA\uFF1A"},{default:f(()=>[s(o,{modelValue:e.value.leaderId,"onUpdate:modelValue":l[3]||(l[3]=N=>e.value.leaderId=N),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9",options:B.value,onChange:m},null,8,["modelValue","options"])]),_:1}),s(E,{label:"\u90E8\u95E8\u8BF4\u660E\uFF1A",name:"remark"},{default:f(()=>[s($,{modelValue:e.value.remark,"onUpdate:modelValue":l[4]||(l[4]=N=>e.value.remark=N),placeholder:"\u8BF7\u8F93\u5165",maxlength:300},null,8,["modelValue"])]),_:1}),s(E,{style:{float:"right"},class:"dialogBtnBox"},{default:f(()=>[p("div",{class:"bt bt-grey btn-submit",onClick:b},[...Ne]),Fe]),_:1})]),_:1},8,["data","reset-type"]),c(` <t-enhanced-table\r
          ref="tableRef"\r
          table-layout="auto"\r
          row-key="id"\r
          :tree="{ childrenKey: 'children' }"\r
          :data="options"\r
          :columns="TEST_COLUMNS"\r
          class="tableRef"\r
        ></t-enhanced-table> `),c(" end ")]),_:1},8,["visible"])])}}});var ye=W(Ce,[["__scopeId","data-v-493d6187"],["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/permission/dept/components/DialogForm.vue"]]);const Se=[{title:"\u90E8\u95E8\u540D\u79F0",align:"left",colKey:"deptName",minWidth:"210px"},{title:"\u90E8\u95E8\u8D1F\u8D23\u4EBA",ellipsis:!0,colKey:"leaderName",cell:(g,{row:r})=>g("p",{class:"ellipsis"},r.leaderName?r.leaderName:"--")},{title:"\u6392\u5E8F",ellipsis:!0,colKey:"sortNo"},{title:"\u521B\u5EFA\u65E5\u671F",ellipsis:!0,colKey:"createDay",width:"15vw",sortType:"all"},{title:"\u90E8\u95E8\u72B6\u6001",width:"15vw",ellipsis:!0,colKey:"dataState",cell:(g,{row:r})=>{var v;const F={0:{label:"\u542F\u7528"},1:{label:"\u7981\u7528"}};return g("span",{class:`status-dot status-dot-${r.dataState==="0"?"1":"0"}`},(v=F[r.dataState])==null?void 0:v.label)}},{title:"\u90E8\u95E8\u8BF4\u660E",colKey:"remark",minWidth:200},{align:"left",fixed:"right",width:210,minWidth:"240px",colKey:"op",title:"\u64CD\u4F5C"}];const Be={class:"deptAdmin baseList"},ke={class:"tableBoxs"},xe={class:"newBox"},Te={class:"updateTime"},Ae={key:1},Ve=["onClick"],Ie=["onClick"],$e=["onClick"],ze=["onClick"],Le=J({__name:"TableList",props:{listData:{type:Object,default:()=>({})},pagination:{type:Object,default:()=>({})}},emits:["fetchData","handleSetupContract","handleBulid","handleClickDelete","handleClickDisable"],setup(g,{expose:r,emit:F}){const v=ae({childrenKey:"childCount",treeNodeColumnIndex:0,indent:25,expandTreeNodeOnClick:!0}),_=t(null),h=u=>{console.log(u,"value"),Y({parentDeptNo:u.row.deptNo}).then(d=>{const m=d.data.map(A=>({...A,childCount:Boolean(A.childCount)}));u.row.deptNo==="100001000000000"?_.value.resetData(m):_.value.appendTo(u.row.deptNo,m),console.log(d,"ffffff")})},D=u=>{console.log("\u5237\u65B0\u5217\u8868\u6570\u636E",u),_.value.remove(u)},S=(u,d)=>{console.log("\u5237\u65B0\u5217\u8868\u6570\u636E",u,d),_.value.setData(u,d),d.childCount&&d.childCount.length>0&&d.childCount.forEach(m=>{S(m.deptNo,{...m,dataState:d.dataState})})},e=g;r({deleteRefreshTable:D,editRefreshTable:S,rehandleExpandChange:h});const C=F;P(e,()=>{k.value=e.listData,V.value=e.pagination,B.value=!1});const k=t([]),V=t({defaultPageSize:10,total:0,defaultCurrent:1}),B=t(!0),i=(u,d)=>{console.log(u,d,"ffffffffff"),u.dataState==="0"&&(u.tg?C("handleSetupContract",{...u}):C("handleSetupContract",{data:u,tg:d}))},x=t(-1),L=u=>{C("handleClickDelete",u),x.value=u.rowIndex},I=u=>{C("handleClickDisable",u)},T=()=>{C("handleBulid")};return(u,d)=>{const m=y("t-tooltip"),A=y("t-enhanced-table");return R(),U("div",Be,[p("div",ke,[p("div",xe,[p("button",{class:"bt newBoxbutton mt-16",onClick:d[0]||(d[0]=n=>T())}," \u65B0\u589E\u90E8\u95E8 ")]),s(A,{ref_key:"table",ref:_,data:k.value,tree:v,columns:ue(Se),"row-key":"deptNo","vertical-align":"middle",hover:!0,loading:B.value,"table-layout":"auto",onTreeExpandChange:h},{updateTime:f(({row:n})=>[p("div",Te,[p("span",null,O(n.updateTime||"2023-3-23 3:33:33"),1)])]),remark:f(({row:n})=>{var b;return[((b=n.remark)==null?void 0:b.length)>18?(R(),le(m,{key:0,class:"title4",content:n.remark||"--"},{default:f(()=>[oe(O(n.remark||"--"),1)]),_:2},1032,["content"])):(R(),U("span",Ae,O(n.remark||"--"),1))]}),op:f(({row:n})=>[p("a",{class:"btn-dl line btn-split-right pdo",onClick:b=>L(n)},"\u5220\u9664",8,Ve),p("a",{class:G(`${n.dataState==="0"?"btn-dl":""} line btn-split-right font-bt`),onClick:b=>I(n)},O(n.dataState==="0"?"\u7981\u7528":"\u542F\u7528"),11,Ie),p("a",{class:"font-bt line",onClick:b=>i(n,"edit")},"\u7F16\u8F91",8,$e),p("a",{class:G([n.dataState==="0"?"":"disabled","font-bt btn-split-left"]),onClick:b=>i(n,"add")},"\u65B0\u589E\u90E8\u95E8",10,ze)]),empty:f(()=>[s(_e)]),_:1},8,["data","tree","columns","loading"])])])}}});var je=W(Le,[["__scopeId","data-v-556a31fe"],["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/permission/dept/components/TableList.vue"]]);const Oe={class:"deptAdmin min-h bg-wt"},Re=J({__name:"index",setup(g){const r=t(null),F=t(!1),v=t({}),_=t(!1),h=t({dataState:"0",parentDeptNo:""}),D=t("\u65B0\u589E\u90E8\u95E8"),S=t(!1),e=t(!1),C=t("\u90E8\u95E8"),k=t(!1),V=ne(),B=t(""),i=t({}),x=t(null),L=t("\u90E8\u95E8"),I=t({pageSize:10,pageNum:1}),T={deptName:"",dataStatus:void 0};P(()=>V.path,o=>{B.value=o});const u=t({...T});X(()=>{m({parentDeptNo:"100001000000000",deptName:"",dataStatus:""})});const d=(o,$)=>{$==="edit"?o.leaderId!==o.originLeaderId||o.sortNo!==o.originSortNo?r.value.rehandleExpandChange({row:{deptNo:"100001000000000"}}):r.value.editRefreshTable(o.deptNo,o):r.value.rehandleExpandChange({row:{deptNo:"100001000000000"}})},m=async o=>{const $={...o,parentDeptNo:"100001000000000"};_.value=!0,Y($).then(H=>{H.code===200&&(v.value=H.data.map(K=>({...K,childCount:Boolean(K.childCount)})))}).catch(()=>{_.value=!1})},A=o=>{i.value=o,o.dataState==="0"?e.value=!0:n()},n=()=>{e.value=!1,b()},b=async()=>{console.log(i.value,"currrentData.value"),pe({deptNo:i.value.deptNo,parentDeptNo:i.value.parentDeptNo,dataState:i.value.dataState==="0"?"1":"0"}).then(o=>{o.code===200&&(r.value.editRefreshTable(i.value.deptNo,{...i.value,dataState:i.value.dataState==="0"?"1":"0"}),z.success(`${i.value.dataState==="0"?"\u7981\u7528":"\u542F\u7528"}\u6210\u529F`),m(),x.value.fetchData())})},j=t(NaN),a=o=>{o.dataState==="0"?z.error("\u542F\u7528\u72B6\u6001\u4E0B\u4E0D\u53EF\u5220\u9664"):(j.value=o.deptNo,S.value=!0)},l=()=>{S.value=!1,w()},w=async()=>{_.value=!0,ve(j.value).then(o=>{o.code===200&&(z.success("\u5220\u9664\u6210\u529F"),_.value=!1,m(),x.value.fetchData(),r.value.deleteRefreshTable(j.value))}).catch(()=>{_.value=!1})},E=()=>{F.value=!1,S.value=!1,e.value=!1,k.value=!1},q=()=>{D.value="\u65B0\u589E\u90E8\u95E8",h.value={parentDeptNo:"",dataState:"0"},F.value=!0},M=o=>{console.log(o,"itemmmm"),o.tg==="add"?(D.value="\u65B0\u589E\u90E8\u95E8",h.value={parentDeptNo:o.data.deptNo,dataState:o.data.dataState}):(D.value="\u7F16\u8F91\u90E8\u95E8",h.value=JSON.parse(JSON.stringify(o.data))),F.value=!0};return(o,$)=>(R(),U("div",Oe,[c(" end "),c(" \u8868\u683C "),s(je,{ref_key:"tableRef",ref:r,"list-data":v.value,pagination:I.value,onHandleSetupContract:M,onHandleBulid:q,onHandleClickDelete:a,onHandleClickDisable:A,onFetchData:m},null,8,["list-data","pagination"]),c(" end "),c(" \u65B0\u589E\uFF0C\u7F16\u8F91\u5F39\u7A97 "),s(ye,{ref_key:"dialogForm",ref:x,visible:F.value,title:D.value,data:h.value,"form-data":u.value,onHandleClose:E,onFetchData:m,onRefreshTable:d},null,8,["visible","title","data","form-data"]),c(" end "),c(" \u751F\u4EA7\u73AF\u5883\u7981\u7528\u64CD\u4F5C\u5F39\u7A97 "),s(me,{"confirm-visible":k.value,onHandleClose:E},null,8,["confirm-visible"]),c(" end "),c(" \u5220\u9664\u5F39\u5C42 "),s(se,{visible:S.value,"delete-text":C.value,onHandleDelete:l,onHandleClose:E},null,8,["visible","delete-text"]),c(" end "),c(" end "),c(" \u7981\u7528\u542F\u7528\u5F39\u5C42 "),s(fe,{visible:e.value,dataState:i.value.dataState,confirmText:L.value,onHandleClick:n,onHandleClose:E},null,8,["visible","dataState","confirmText"]),c(" end ")]))}});var Me=W(Re,[["__scopeId","data-v-381e04f4"],["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/permission/dept/index.vue"]]);export{Me as default};
