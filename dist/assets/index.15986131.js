import{d as O,b as ie,r as n,e as g,h as S,q as p,i as d,w as f,A as H,g as h,f as M,_ as j,o as _,F as de,E as ce,u as re,y as ve,ak as pe,al as me,am as fe,B as he,n as T,a0 as ge,an as be,M as x,ao as Ce,ap as ye,aq as De,ar as Fe}from"./index.c5b6faf2.js";import{c as _e,d as Be}from"./date.a9e2d8fb.js";import{E as we,F as K}from"./commonData.8892e613.js";import{S as ke}from"./switchBar.3a8341ea.js";import{N as Se}from"./index.ea73f821.js";const Re=[{colKey:"row-select",type:"multiple",width:46},{title:"\u6D88\u606F\u6807\u9898",minWidth:240,colKey:"title"},{title:"\u6D88\u606F\u5185\u5BB9",minWidth:180,colKey:"content"},{title:"\u63A5\u6536\u65F6\u95F4",minWidth:300,colKey:"createTime"},{title:"\u6D88\u606F\u7C7B\u578B",minWidth:180,colKey:"type"},{align:"left",fixed:"right",width:114,minWidth:"114px",colKey:"op",title:"\u64CD\u4F5C"}],Ne={class:"baseList"},ze={class:"tableBoxs"},Ee={key:0},Ve={key:1},xe={class:"operateCon"},Ae=["onClick"],Te=["onClick"],Oe="id",je=O({__name:"TableList",props:{listData:{type:Object,default:()=>[]},total:{type:Number,default:0},pagination:{type:Object,default:()=>({})},dataLoading:{type:Boolean,default:!1}},emits:["getCurrent","handleCancelOpen","handleClickDelete","getDeleteNum","handleOperate"],setup(r,{expose:R,emit:D}){const m=ie(),c=n([]),b=D,B=(t,u)=>{c.value=[t.id],b("handleOperate",t.id,u),m.push({path:"/intelligence/facility",query:{id:t.relevantId}})},w=(t,u)=>{c.value=[t.id],b("handleClickDelete",t,u)},i=t=>{b("getCurrent",t)},C=(t,u)=>{c.value=t,b("getDeleteNum",c.value)};return R({selectedRowKeys:c}),(t,u)=>{const F=g("t-table"),v=g("t-pagination");return _(),S("div",Ne,[p("div",ze,[d(F,{data:r.listData,columns:H(Re),"row-key":Oe,"selected-row-keys":c.value,"vertical-align":"middle",hover:!0,loading:r.dataLoading,"table-layout":"fixed","table-content-width":"100%",onSelectChange:C},{type:f(({row:o})=>[o.type===0?(_(),S("span",Ee,"\u62A5\u8B66\u901A\u77E5")):(_(),S("span",Ve,"\u534F\u540C\u5DE5\u4F5C"))]),op:f(({row:o})=>[p("div",xe,[p("a",{class:"btn-dl",onClick:k=>w(o,"delete")},"\u5220\u9664",8,Ae),p("a",{class:"font-bt",onClick:k=>B(o,"read")},"\u67E5\u770B",8,Te)])]),empty:f(()=>[d(Se)]),_:1},8,["data","columns","selected-row-keys","loading"]),h(" \u5206\u9875 "),r.total>10?(_(),M(v,{key:0,modelValue:r.pagination.pageNum,"onUpdate:modelValue":u[0]||(u[0]=o=>r.pagination.pageNum=o),pageSize:r.pagination.pageSize,"onUpdate:pageSize":u[1]||(u[1]=o=>r.pagination.pageSize=o),total:r.total,onChange:i},null,8,["modelValue","pageSize","total"])):h("v-if",!0),h(" end ")])])}}});var $e=j(je,[["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/news/components/TableList.vue"]]);const Le={class:"formBox"},Ke=O({__name:"SearchForm",props:{searchData:{type:Object,default:()=>({})}},emits:["handleSearch","handleReset","handleClear"],setup(r,{emit:R}){const D=R,m=n(null),c=n([]),b=()=>{c.value=[],m.value.reset(),D("handleReset")},B=()=>{D("handleSearch",c.value)},w=(C,t)=>{t.trigger==="clear"&&D("handleClear",t.trigger)},i=C=>{D("handleClear",C)};return(C,t)=>{const u=g("t-option"),F=g("t-select"),v=g("t-form-item"),o=g("t-col"),k=g("t-date-range-picker"),N=g("t-row"),a=g("t-form");return _(),S("div",Le,[d(a,{ref_key:"form",ref:m,model:r.searchData,"label-width":98},{default:f(()=>[d(N,null,{default:f(()=>[d(o,null,{default:f(()=>[d(v,{label:"\u6D88\u606F\u7C7B\u578B\uFF1A",name:"type"},{default:f(()=>[d(F,{modelValue:r.searchData.type,"onUpdate:modelValue":t[0]||(t[0]=s=>r.searchData.type=s),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9",title:"",onClear:t[1]||(t[1]=s=>i("type"))},{default:f(()=>[(_(!0),S(de,null,ce(H(we),(s,y)=>(_(),M(u,{key:y,value:s.id,label:s.value},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),d(o,null,{default:f(()=>[d(v,{label:"\u63A5\u6536\u65F6\u95F4\uFF1A",name:"timeData"},{default:f(()=>[d(k,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=s=>c.value=s),placeholder:["\u5F00\u59CB\u65E5\u671F","\u7ED3\u675F\u65E5\u671F"],clearable:"",onChange:w},null,8,["modelValue"])]),_:1})]),_:1}),h(" \u6309\u94AE\u533A\u57DF "),d(o,{class:"searchBtn"},{default:f(()=>[p("button",{type:"button",class:"bt-grey wt-60",onClick:t[3]||(t[3]=s=>b())}," \u91CD\u7F6E "),p("button",{type:"button",class:"bt wt-60",onClick:t[4]||(t[4]=s=>B())}," \u641C\u7D22 ")]),_:1})]),_:1})]),_:1},8,["model"])])}}});var He=j(Ke,[["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/news/components/SearchForm.vue"]]);const Me={class:"min-h subscribe bg-wt"},Ue={class:"marg-main newBox"},Ie={class:"tabBtn"},We=O({__name:"index",setup(r){re();const R=n(!1),D=n(!1),m=n([]),c=n(!1),b=n(0),B=n(""),w=n(null),i=n(0),C=n(!1),t=n(null),u=n(null),F=n(!0),v=n(null),o=n(""),k=n([]),N=n(!1),a=n({pageSize:10,pageNum:1,isRead:0});ve(()=>{U(),s(),y()});const s=async()=>{c.value=!1;try{const e=await pe(a.value);m.value=e.data.records,b.value=Number(e.data.total)}finally{c.value=!1}},y=async()=>{await me().then(e=>{if(e.code===200){const l=e.data;K.forEach(E=>{E.id===0?E.value=l.unReadCount:E.value=l.completedReadCount}),k.value=K}})},U=async()=>{await fe().then(e=>{e.code===200&&(e.data===0?F.value=!1:F.value=!0)})},I=e=>{a.value.pageNum=1,e.length>0&&(a.value.startTime=_e(e[0]),a.value.endTime=Be(e[1])),s(),y()},W=()=>{w.value.currentId=0,a.value={pageSize:10,pageNum:1},s(),y()},q=e=>{a.value.pageNum=e.current,a.value.pageSize=e.pageSize,s(),y()},G=e=>{i.value=[],t.value.selectedRowKeys=[],a.value={pageSize:a.value.pageSize,isRead:e},a.value.pageNum=1,s(),y()},P=e=>{e==="type"?delete a.value.type:(delete a.value.startTime,delete a.value.endTime),a.value={...a.value},s(),y()},Q=e=>{B.value=e,R.value=!0},J=e=>{B.value=e.id,D.value=!0},$=()=>{C.value=!1,i.value=[],t.value.selectedRowKeys=[]},X=e=>{i.value=e.map(l=>Number(l))},Y=(e,l)=>{u.value=l,i.value=[e.id],o.value="\u6D88\u606F",v.value=null,z()},Z=e=>{i.value.length>0&&(u.value=e,v.value=null,o.value="\u6D88\u606F",z())},ee=e=>{i.value.length>0&&a.value.isRead===0&&(u.value=e,v.value=null,v.value="\u786E\u8BA4\u5DF2\u8BFB",o.value="\u8BE5\u6D88\u606F\u6807\u8BB0\u4E3A\u5DF2\u8BFB",z())},te=e=>{m.value.length>0&&a.value.isRead===0&&(u.value=e,v.value=null,v.value="\u786E\u8BA4\u5DF2\u8BFB",o.value="\u6240\u6709\u6D88\u606F\u6807\u8BB0\u4E3A\u5DF2\u8BFB",z())},ae=e=>{m.value.length>0&&(u.value=e,v.value=null,o.value="\u5168\u90E8\u6D88\u606F",z())},z=()=>{C.value=!0},le=async e=>{await be(e?1:0).then(l=>{l.code===200&&x.success("\u64CD\u4F5C\u6210\u529F")})},ue=async()=>{await Ce(a.value.isRead).then(e=>{e.code===200&&(x.success("\u5220\u9664\u6210\u529F"),A())})},ne=async()=>{await ye(i.value).then(e=>{e.code===200&&(x.success("\u5220\u9664\u6210\u529F"),A())})},oe=async()=>{await De(i.value).then(e=>{e.code===200&&(x.success("\u64CD\u4F5C\u6210\u529F"),A())})},se=async()=>{await Fe(i.value).then(e=>{e.code===200&&(x.success("\u64CD\u4F5C\u6210\u529F"),A())})},A=()=>{N.value=!0,$(),s(),y(),setTimeout(()=>{N.value=!1},800)},L=async(e,l)=>{l!==void 0&&e!==void 0&&(i.value=[e],u.value=l),u.value==="allDelete"?ue():u.value==="delete"?ne():u.value==="allRead"?oe():se()};return(e,l)=>{const E=g("t-switch");return _(),S("div",Me,[h(" \u7B5B\u9009\u533A\u57DF "),d(He,{"search-data":a.value,onHandleSearch:I,onHandleReset:W,onHandleClear:P},null,8,["search-data"]),h(" end "),h(" tab\u5BFC\u822A "),p("div",Ue,[d(ke,{ref_key:"tabBar",ref:w,isTab:N.value,data:k.value,onChangeId:G},null,8,["isTab","data"]),p("div",Ie,[he(" \u8BED\u97F3\u63D0\u9192"),d(E,{modelValue:F.value,"onUpdate:modelValue":l[0]||(l[0]=V=>F.value=V),onChange:le},null,8,["modelValue"]),p("button",{class:T(["bt wt-120",i.value.length>0?"":"bt-forbid"]),onClick:l[1]||(l[1]=V=>Z("delete"))}," \u5220\u9664 ",2),p("button",{class:T(["bt wt-120",i.value.length>0&&a.value.isRead===0?"":"bt-forbid"]),onClick:l[2]||(l[2]=V=>ee("read"))}," \u6807\u8BB0\u4E3A\u5DF2\u8BFB ",2),p("button",{class:T(["bt wt-120",m.value.length>0&&a.value.isRead===0?"":"bt-forbid"]),onClick:l[3]||(l[3]=V=>te("allRead"))}," \u5168\u90E8\u5DF2\u8BFB ",2),p("button",{class:T(["bt wt-120",m.value.length>0?"":"bt-forbid"]),onClick:l[4]||(l[4]=V=>ae("allDelete"))}," \u5168\u90E8\u5220\u9664 ",2)])]),h(" \u8868\u683C "),d($e,{ref_key:"table",ref:t,"list-data":m.value,pagination:a.value,total:b.value,onHandleClickDelete:Y,onHandleOpen:Q,onGetCurrent:q,onHandleCancelOpen:J,onGetDeleteNum:X,onHandleOperate:L},null,8,["list-data","pagination","total"]),h(" end "),h(" \u5220\u9664\u5F39\u5C42 "),d(ge,{visible:C.value,title:v.value,"delete-text":o.value,onHandleDelete:L,onHandleClose:$},null,8,["visible","title","delete-text"]),h(" end ")])}}});var Xe=j(We,[["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/news/index.vue"]]);export{Xe as default};
