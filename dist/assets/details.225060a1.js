import{d as ne,r as s,o as u,h as d,q as e,F as P,E as X,n as K,Y as Ie,z as l,_ as se,C as xe,e as B,i as _,w as o,g as r,f as H,A as y,B as W,ah as _e,c as Ve,b as Ne,y as Se,M as Le,p as ze,m as je}from"./index.c5b6faf2.js";import{w as Z,x as Oe,y as $e}from"./commonData.8892e613.js";import{L as Ue,a as Ke,b as Me}from"./constants.b83a4af6.js";import{m as M,n as U,o as ce,p as ve}from"./date.a9e2d8fb.js";import{f as Pe,h as He,i as qe,j as Re,k as Je}from"./intelligence.a10604ee.js";import{N as le}from"./index.ea73f821.js";import{S as Ge}from"./switchBar.3a8341ea.js";import{I as Ye}from"./index.23d6bd3e.js";const Qe={class:"headBox"},We={class:"sw-box"},Xe=["onClick"],Ze=ne({__name:"switchBartop",props:{data:{type:Array,default:[]}},emits:["changeId","handleFloorEdit"],setup(g,{expose:V,emit:z}){const A=z,E=s(0),x=(k,D)=>{E.value=D,A("changeId",k,D)};return V({currentId:E}),(k,D)=>(u(),d("div",Qe,[e("div",We,[(u(!0),d(P,null,X(g.data,(C,w)=>(u(),d("span",{key:w,class:K({title:!0,line:E.value==w}),onClick:Ie(T=>x(C.id,w),["stop"])},l(C.name),11,Xe))),128))])]))}});var et=se(Ze,[["__scopeId","data-v-1de33b96"],["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/components/switchBar/switchBartop.vue"]]);const tt={class:"dialogBox tableDialog lookSelectDialog"},at={class:"dialogCenter"},lt=ne({__name:"LookData",props:{dialogData:{type:Array,default:()=>[]},dialogVisible:{type:Boolean,default:!1},pagination:{type:Object,default:()=>({})},dataLoading:{type:Boolean,default:!1}},emits:["handleCloseDialog","getCurrent","handleSearch"],setup(g,{emit:V}){const z=g,A=V,E=s(),x=s(null),k=s(!1),D=s([]),C=s(0),w=s(0);xe(z,h=>{k.value=h.dialogVisible});const T=()=>{x.value.reset(),C.value=0,w.value=0,D.value=[],A("handleCloseDialog")},q=h=>{A("getCurrent",h)},n=h=>{if(w.value=h,h<3){const i=Z.filter(f=>f.id===h);A("handleSearch",_e(i[0].value)),D.value=[]}},R=h=>{A("handleSearch",h)};return(h,i)=>{const f=B("t-option"),ee=B("t-select"),J=B("t-date-range-picker"),N=B("t-form-item"),I=B("t-col"),j=B("t-row"),G=B("t-form"),O=B("t-table"),S=B("t-dialog");return u(),d("div",tt,[_(S,{visible:k.value,"onUpdate:visible":i[2]||(i[2]=m=>k.value=m),header:"\u67E5\u770B\u6570\u636E","on-close":T,footer:!1,onCloseBtnClick:T},{default:o(()=>[e("div",at,[r(" \u641C\u7D22 "),_(G,{ref_key:"ruleForm",ref:x,data:g.pagination,"label-width":80},{default:o(()=>[_(j,null,{default:o(()=>[_(I,{span:12},{default:o(()=>[_(j,null,{default:o(()=>[_(I,{span:8},{default:o(()=>[_(N,{label:"\u65F6\u95F4\u8303\u56F4\uFF1A",name:"name"},{default:o(()=>[_(ee,{modelValue:C.value,"onUpdate:modelValue":i[0]||(i[0]=m=>C.value=m),filterable:"",placeholder:"\u8BF7\u9009\u62E9",onChange:n},{default:o(()=>[(u(!0),d(P,null,X(y(Z),(m,c)=>(u(),H(f,{key:c,value:m.id,label:m.value,title:""},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),w.value===3?(u(),H(J,{key:0,modelValue:D.value,"onUpdate:modelValue":i[1]||(i[1]=m=>D.value=m),placeholder:["\u5F00\u59CB\u65E5\u671F","\u7ED3\u675F\u65E5\u671F"],onChange:R},null,8,["modelValue"])):r("v-if",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),r(" end "),r(" table \u6570\u636E "),_(O,{ref_key:"regTable",ref:E,"row-key":"rowKey",data:g.dialogData,columns:y(Ue),pagination:g.pagination.total>5?g.pagination:null,"disable-data-page":g.pagination.total<=5,loading:g.dataLoading,"cell-empty-content":"-",onPageChange:q},{rowIndex:o(({rowIndex:m})=>[W(l(m+1),1)]),time:o(({row:m})=>[e("span",null,l(m.time!==void 0?y(M)(m.time):"--"),1)]),empty:o(()=>[_(le)]),_:1},8,["data","columns","pagination","disable-data-page","loading"]),r(" end ")])]),_:1},8,["visible"])])}}});var nt=se(lt,[["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/intelligence/equipment/components/LookData.vue"]]);const p=g=>(ze("data-v-23d3c275"),g=g(),je(),g),st={class:"detail-base intelligenc"},ut={ref:"mainHeight",class:"bg-wt"},ot={class:"info-block"},it={class:"info-item"},dt=p(()=>e("h1",{class:"label-wt"},"\u8BBE\u5907\u540D\u79F0\uFF1A",-1)),ct={class:"info-item"},vt=p(()=>e("h1",{class:"label-wt"},"\u6240\u5C5E\u4EA7\u54C1\uFF1A",-1)),rt={class:"info-item"},_t=p(()=>e("h1",{class:"label-wt"},"DeviceSecret\uFF1A",-1)),mt={class:"info-item"},pt=p(()=>e("h1",{class:"label-wt"},"ProductKey\uFF1A",-1)),ht={class:"info-item"},gt=p(()=>e("h1",{class:"label-wt"},"\u8BBE\u5907\u72B6\u6001\uFF1A",-1)),ft={key:0,class:"bt-small"},Ft={key:1,class:"undefinedBtn"},Bt={key:2,class:"undefinedBtn"},yt={key:3,class:"forbidBtn"},Dt={class:"info-item"},bt=p(()=>e("h1",{class:"label-wt"},"\u63A5\u5165\u4F4D\u7F6E\uFF1A",-1)),kt={key:0},Tt={key:1},Et={key:2},Ct={ref:"mainHeight",class:"bg-wt min-steph height mt-24"},wt={key:0},At={class:"info-block"},It={class:"info-item"},xt=p(()=>e("h1",null,"\u8BBE\u5907\u540D\u79F0\uFF1A",-1)),Vt={class:"info-item"},Nt=p(()=>e("h1",null,"\u5907\u6CE8\u540D\u79F0\uFF1A",-1)),St={class:"info-item"},Lt=p(()=>e("h1",null,"\u8BBE\u5907\u7C7B\u578B\uFF1A",-1)),zt={class:"info-item"},jt=p(()=>e("h1",null,"\u5730\u57DF\uFF1A",-1)),Ot={class:"info-item"},$t=p(()=>e("h1",null,"\u8282\u70B9\u7C7B\u578B\uFF1A",-1)),Ut=p(()=>e("div",{class:"info-item"},[e("h1",null,"\u8BA4\u8BC1\u65B9\u5F0F\uFF1A"),e("span",null,"\u8BBE\u5907\u5BC6\u94A5")],-1)),Kt={class:"info-item"},Mt=p(()=>e("h1",null,"IP\u5730\u5740\uFF1A",-1)),Pt={class:"info-item"},Ht=p(()=>e("h1",null,"\u56FA\u4EF6\u7248\u672C\uFF1A",-1)),qt={class:"info-item"},Rt=p(()=>e("h1",null,"\u521B\u5EFA\u4EBA\uFF1A",-1)),Jt={class:"info-item"},Gt=p(()=>e("h1",null,"\u521B\u5EFA\u65F6\u95F4\uFF1A",-1)),Yt={class:"info-item"},Qt=p(()=>e("h1",null,"\u6FC0\u6D3B\u65F6\u95F4\uFF1A",-1)),Wt={key:1},Xt={class:"modelBox"},Zt={class:"modelL"},ea={class:"modelList"},ta=["onClick"],aa={class:"modelR"},la=p(()=>e("span",null,"\u8BBE\u5907\u4FE1\u606F",-1)),na={key:0},sa={key:1},ua={class:"operateCon"},oa=["onClick"],ia={key:1},da={class:"timeSelect"},ca=p(()=>e("span",null,"\u65F6\u95F4\u8303\u56F4\uFF1A",-1)),va={class:"update"},ra={key:0},_a={key:1},ma={key:0,class:"hover"},pa={class:"intelNext"},re="index",ha=ne({__name:"details",setup(g){const V=Ve(),z=Ne(),A=s(""),E=s(""),x=s(0),k=s(0),D=s(0),C=s(!1),w=s([]),T=s([]),q=s(!1),n=s({}),R=s([]),h=s({}),i=s({startTime:new Date(U()).getTime(),endTime:new Date().getTime()}),f=s([]),ee=s(null),J=s(null),N=s(null),I=s(!1),j=s(null),G=s(0),O=s(0),S=s([]),m=s(!1),c=s({pageSize:5,pageNum:1,startTime:new Date(U()).getTime(),endTime:new Date().getTime()}),ue=s([]),Y=s({pageSize:10,pageNum:1}),te=s(0);Se(()=>{V.query.iotId!==void 0&&(A.value=V.query.iotId,E.value=V.query.productKey,me())});const me=async()=>{const t={iotId:A.value,productKey:E.value},v=await Pe(t);v.code===200&&(n.value=v.data,c.value.deviceId=n.value.deviceId,c.value.deviceName=n.value.deviceName,n.value.remark&&(f.value=n.value.remark.split(",")),ae(n.value))},ae=async t=>{const v={productKey:E.value},b=await He(v);if(b.code===200){const F=JSON.parse(b.data.thingModelJson);console.log(F),ue.value=F.functionBlocks,k.value===0?pe(t,F.services):Q(t,F.services)}},pe=async(t,v)=>{h.value={...h.value,deviceName:t.deviceName,productKey:E.value};const b=await qe(h.value);if(b.code===200){const F=b.data.list.propertyStatusInfo;R.value=F}},Q=async(t,v)=>{const b=m.value?i.value.endTime:j.value;i.value={...i.value,iotId:t.iotId,endTime:I.value?b:i.value.endTime};const F=await Re(i.value);F.code===200&&(I.value=F.data.nextValid,j.value=F.data.nextTime,T.value=[...T.value,...F.data.serviceInfoList],m.value&&Le.success("\u5237\u65B0\u6210\u529F"),m.value=!1,console.log(T.value))},$=async()=>{const t=await Je(c.value);if(t.code===200){const v=t.data.records;w.value=v,te.value=Number(t.data.total),c.value.total=Number(t.data.total)}},he=t=>{x.value=t},ge=t=>{k.value=t,ae(n.value)},oe=(t,v)=>{D.value=t,I.value=!1,m.value=!0,T.value=[],t>0&&v!==void 0?h.value.functionBlockId=v.functionBlockId:delete h.value.functionBlockId,ae(n.value)},ie=t=>{Y.value.pageNum=t.current,Y.value.pageSize=t.pageSize},fe=t=>{c.value.functionId=t.identifier,C.value=!0,$()},Fe=()=>{C.value=!1,c.value.startTime=new Date(U()).getTime(),c.value.endTime=new Date().getTime(),$()},Be=t=>{J.value=!0,delete c.value.startTime,delete c.value.endTime,c.value.endTime=new Date().getTime(),t==="1"?(c.value.startTime=new Date(U()).getTime(),N.value=60*60*1e3):t==="24"?(c.value.startTime=new Date(ce()).getTime(),N.value=24*60*60*1e3):t==="7"?(c.value.startTime=new Date(ve()).getTime(),N.value=7*24*60*60*1e3):(N.value=null,c.value.startTime=new Date(t[0]).getTime(),c.value.endTime=new Date(t[1]).getTime()),$()},ye=()=>{c.value={pageSize:5,pageNum:1},$()},De=t=>{c.value.pageNum=t.current,c.value.pageSize=t.pageSize,$()},be=()=>{z.go(-1)},ke=()=>{I.value&&Q(n.value)},Te=t=>{if(O.value=t,console.log(t),t<3){const v=Z.filter(b=>b.id===t);de(_e(v[0].value)),S.value=[]}},de=t=>{delete i.value.startTime,delete i.value.endTime,T.value=[],I.value=!1,i.value.endTime=new Date().getTime(),t==="1"?i.value.startTime=new Date(U()).getTime():t==="24"?i.value.startTime=new Date(ce()).getTime():t==="7"?i.value.startTime=new Date(ve()).getTime():(N.value=null,i.value.startTime=new Date(t[0]).getTime(),i.value.endTime=new Date(t[1]).getTime()),Q(n.value)},Ee=()=>{O.value<3?i.value.endTime=new Date().getTime():(i.value.startTime=new Date(S.value[0]).getTime(),i.value.endTime=new Date(S.value[1]).getTime()),m.value=!0,T.value=[],Q(n.value)};return(t,v)=>{const b=B("t-card"),F=B("t-table"),Ce=B("t-option"),we=B("t-select"),Ae=B("t-date-range-picker");return u(),d(P,null,[e("div",st,[r(" \u8BBE\u5907\u4FE1\u606F "),e("div",ut,[_(b,{title:"\u8BBE\u5907\u4FE1\u606F"},{default:o(()=>[e("div",ot,[e("div",it,[dt,e("span",null,l(n.value.deviceName),1)]),e("div",ct,[vt,e("span",null,l(n.value.productName),1)]),e("div",rt,[_t,e("span",null,l(n.value.deviceSecret),1)]),e("div",mt,[pt,e("span",null,l(n.value.productKey),1)]),e("div",ht,[gt,e("span",null,[n.value.status==="ONLINE"?(u(),d("span",ft,"\u5728\u7EBF")):n.value.status==="OFFLINE"?(u(),d("span",Ft,"\u79BB\u7EBF")):n.value.status==="UNACTIVE"?(u(),d("span",Bt,"\u672A\u6FC0\u6D3B")):(u(),d("span",yt,"\u5DF2\u7981\u7528"))])]),e("div",Dt,[bt,e("span",null,[f.value.length===1?(u(),d("span",kt,l(f.value[0]),1)):r("v-if",!0),f.value.length===2?(u(),d("span",Tt,l(f.value[0])+"-"+l(f.value[1]),1)):r("v-if",!0),f.value.length===3?(u(),d("span",Et,l(f.value[0])+"-"+l(f.value[1])+"-"+l(f.value[2]),1)):r("v-if",!0)])])])]),_:1})],512),r(" end "),e("div",Ct,[_(et,{ref:"tabBar",data:y(Oe),onChangeId:he},null,8,["data"]),r(" \u8BBE\u5907\u8BE6\u60C5 "),x.value===0?(u(),d("div",wt,[_(b,{title:""},{default:o(()=>[e("div",At,[e("div",It,[xt,e("span",null,l(n.value.deviceName),1)]),e("div",Vt,[Nt,e("span",null,l(n.value.nickname),1)]),e("div",St,[Lt,e("span",null,l(n.value.locationType===0?"\u968F\u8EAB\u8BBE\u5907":"\u56FA\u5B9A\u8BBE\u5907"),1)]),e("div",zt,[jt,e("span",null,l(n.value.region),1)]),e("div",Ot,[$t,e("span",null,l(n.value.nodeType===0?"\u76F4\u8FDE\u8BBE\u5907":"\u7F51\u5173"),1)]),Ut,e("div",Kt,[Mt,e("span",null,l(n.value.ipAddress?n.value.ipAddress:"--"),1)]),e("div",Pt,[Ht,e("span",null,l(n.value.firmwareVersion?n.value.firmwareVersion:"--"),1)]),e("div",qt,[Rt,e("span",null,l(n.value.creator?n.value.creator:"--"),1)]),e("div",Jt,[Gt,e("span",null,l(n.value.gmtCreate),1)]),e("div",Yt,[Qt,e("span",null,l(n.value.gmtActive?n.value.gmtActive:"--"),1)])])]),_:1})])):r("v-if",!0),r(" end "),r(" \u7269\u6A21\u578B\u6570\u636E "),x.value===1?(u(),d("div",Wt,[e("div",Xt,[e("div",Zt,[_(Ge,{ref:"tabBar",data:y($e),onChangeId:ge},null,8,["data"]),e("div",ea,[e("ul",null,[e("li",{class:K(D.value===0?"active":""),onClick:v[0]||(v[0]=a=>oe(0))}," \u9ED8\u8BA4\u6A21\u5757 ",2),(u(!0),d(P,null,X(ue.value,(a,L)=>(u(),d("li",{key:L,class:K(D.value===L+1?"active":""),onClick:ga=>oe(L+1,a)},[e("p",null,l(a.functionBlockName),1),e("p",null,"\u6807\u8BC6\u7B26\uFF1A"+l(a.functionBlockId),1)],10,ta))),128))])])]),e("div",aa,[k.value===0?(u(),H(F,{key:0,data:R.value,columns:y(Ke),"row-key":re,"vertical-align":"middle",hover:!0,pagination:Y.value.total>10?Y.value:null,"disable-data-page":te.value<=10,loading:q.value,"table-layout":"fixed","table-content-width":"100%",onPageChange:ie},{rowIndex:o(({rowIndex:a})=>[W(l(a+1),1)]),information:o(({row:a})=>[la]),value:o(({row:a})=>[a.name==="\u79BB\u5E8A\u65F6\u95F4"?(u(),d("span",na,l(y(M)(a.value)),1)):(u(),d("span",sa,l(a.value)+l(a.value?a.unit:"--"),1))]),time:o(({row:a})=>[e("span",null,l(a.time&&a.time!==void 0?y(M)(a.time):"--"),1)]),op:o(({row:a})=>[e("div",ua,[e("a",{class:"font-bt",onClick:L=>fe(a)},"\u67E5\u770B\u6570\u636E",8,oa)])]),empty:o(()=>[_(le)]),_:1},8,["data","columns","pagination","disable-data-page","loading"])):r("v-if",!0),k.value===1?(u(),d("div",ia,[e("div",da,[ca,_(we,{modelValue:G.value,"onUpdate:modelValue":v[1]||(v[1]=a=>G.value=a),filterable:"",placeholder:"\u8BF7\u9009\u62E9",class:"wt-120",onChange:Te},{default:o(()=>[(u(!0),d(P,null,X(y(Z),(a,L)=>(u(),H(Ce,{key:L,value:a.id,label:a.value,title:""},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),O.value===3?(u(),H(Ae,{key:0,modelValue:S.value,"onUpdate:modelValue":v[2]||(v[2]=a=>S.value=a),class:"wt-300",placeholder:["\u5F00\u59CB\u65E5\u671F","\u7ED3\u675F\u65E5\u671F"],onChange:de},null,8,["modelValue"])):r("v-if",!0),e("div",va,[_(y(Ye),{name:"refresh",size:"18px",onClick:Ee})])]),_(F,{data:T.value,columns:y(Me),"row-key":re,"vertical-align":"middle",hover:!0,"max-height":400,loading:q.value,"table-layout":"fixed","table-content-width":"100%",onPageChange:ie},{rowIndex:o(({rowIndex:a})=>[W(l(a+1),1)]),value:o(({row:a})=>[a.name==="\u79BB\u5E8A\u65F6\u95F4"?(u(),d("span",ra,l(y(M)(a.value)),1)):(u(),d("span",_a,l(a.value)+l(a.value?a.unit:"--"),1))]),time:o(({row:a})=>[e("span",null,l(a.time&&a.time!==void 0?y(M)(a.time):"--"),1)]),outputData:o(({row:a})=>[e("div",{class:K({description:!0,descriptionheight:a.outputData.length>18})},[e("span",null,l(a.outputData),1),a.outputData.length>36?(u(),d("span",ma,l(a.outputData),1)):r("v-if",!0)],2)]),type:o(({row:a})=>[W(l(a.type===1?"\u4FE1\u606F":"\u6545\u969C"),1)]),empty:o(()=>[_(le)]),_:1},8,["data","columns","loading"]),e("div",pa,[e("button",{class:K(["bt wt-120",I.value?"":"bt-forbid"]),onClick:ke}," \u4E0B\u4E00\u6B65 ",2)])])):r("v-if",!0)])])])):r("v-if",!0),r(" end ")],512),_(nt,{dialogVisible:C.value,"dialog-data":w.value,pagination:c.value,nextValid:ee.value,preValid:J.value,total:te.value,onHandleSearch:Be,onHandleReset:ye,onHandleCloseDialog:Fe,onGetCurrent:De},null,8,["dialogVisible","dialog-data","pagination","nextValid","preValid","total"])]),e("div",{class:"boxBottom fx fx-ct bg-wt"},[e("button",{class:"bt-grey wt-60",onClick:be},"\u8FD4\u56DE")])],64)}}});var Ea=se(ha,[["__scopeId","data-v-23d3c275"],["__file","D:/project/2023/project-zzyl-v2.1/project-zzyl-admin-vue3-java/src/pages/intelligence/equipment/details.vue"]]);export{Ea as default};
